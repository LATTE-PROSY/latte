<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Mini Neko Web</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Comic+Neue&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-o4fA9bK1d9Pv0tvOa5UecfF7uF4Zya5Uks/IQy8h8xYjvQK9kfvRrE1I9x8GfxK5Pj3y1+RjkhX1l7M3oR4V3A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<style>
:root {
  --bg: #0a0a0a;
  --bg-alt: #111;
  --accent: #ff4fa3;
  --accent2: #ff7cd8;
  --text: #fce7f3;
  --shadow: rgba(255, 79, 163, 0.4);
  --border-radius: 16px;
  --transition: 0.25s ease-in-out;
}
body {
  font-family: 'Roboto', sans-serif;
  background: linear-gradient(135deg, #0a0a0a, #1a0a1a);
  color: var(--text);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  overflow: hidden;
  transition: background var(--transition);
}
.container {
  display: flex;
  gap: 20px;
  width: 95%;
  height: 90%;
}
.card {
  background: var(--bg-alt);
  border-radius: var(--border-radius);
  padding: 16px;
  box-shadow: 0 0 24px var(--shadow);
  display: flex;
  flex-direction: column;
  flex: 1;
  transition: all var(--transition);
}
.card:hover {
  transform: translateY(-4px);
  box-shadow: 0 0 32px var(--accent2);
}
h2 {
  margin-bottom: 10px;
  font-size: 1rem;
  color: var(--accent2);
  text-shadow: 0 0 8px var(--accent);
  display: flex;
  align-items: center;
  gap: 6px;
}
textarea {
  flex: 1;
  border-radius: 12px;
  background: #111;
  color: var(--accent2);
  border: 2px solid var(--accent2);
  padding: 14px;
  font-family: monospace;
  font-size: 14px;
  outline: none;
  resize: none;
  line-height: 1.5em;
  box-shadow: inset 0 0 16px rgba(255, 79, 163, 0.2);
  transition: all var(--transition);
}
textarea:focus {
  border-color: var(--accent);
  box-shadow: inset 0 0 20px var(--shadow);
}
iframe {
  flex: 1;
  border-radius: 12px;
  border: 2px solid var(--accent);
  box-shadow: inset 0 0 12px rgba(255, 124, 216, 0.4);
  transition: all var(--transition);
}
.controls {
  margin-top: 12px;
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}
button {
  padding: 8px 16px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  color: #000;
  font-weight: 700;
  font-family: 'Comic Neue', sans-serif;
  transition: all var(--transition);
  box-shadow: 0 0 12px var(--shadow);
  display: flex;
  align-items: center;
  gap: 6px;
}
button:hover {
  transform: scale(1.08);
  box-shadow: 0 0 24px var(--accent2);
}
input.url {
  flex: 1;
  padding: 8px 12px;
  border-radius: 12px;
  border: 2px solid var(--accent2);
  background: #111;
  color: var(--accent2);
  font-size: 14px;
  outline: none;
  box-shadow: inset 0 0 8px var(--shadow);
}
.linkbox {
  margin-top: 10px;
  display: flex;
  gap: 8px;
}
#viewerView {
  width: 100%;
  height: 100vh;
  background: black;
}
.toggle-theme {
  position: absolute;
  top: 16px;
  right: 16px;
  padding: 8px 12px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  background: var(--accent2);
  color: #000;
  font-weight: 700;
  font-family: 'Comic Neue', sans-serif;
  display: flex;
  align-items: center;
  gap: 6px;
  box-shadow: 0 0 12px var(--shadow);
  transition: all var(--transition);
}
.toggle-theme:hover {
  transform: scale(1.05);
  box-shadow: 0 0 24px var(--accent2);
}
body.light {
  --bg: #fefefe;
  --bg-alt: #fff;
  --accent: #ff4fa3;
  --accent2: #ff7cd8;
  --text: #111;
  --shadow: rgba(255, 79, 163, 0.3);
  background: linear-gradient(135deg, #fefefe, #ffe6f0);
}
body.light textarea, body.light input.url, body.light iframe {
  background: #fff;
  color: var(--accent2);
  border-color: var(--accent2);
}
</style>
</head>
<body>

<button class="toggle-theme"><i class="fa-solid fa-sun"></i> Toggle Theme</button>

<div id="editorView" class="container" style="display:none;">
  <div class="card" style="flex:2;">
    <h2><i class="fa-solid fa-pen-nib"></i> Editor</h2>
    <textarea id="editor"></textarea>
    <div class="controls">
      <button id="btnPublish"><i class="fa-solid fa-globe"></i> Publish</button>
    </div>
    <div class="linkbox">
      <input id="shareUrl" class="url" readonly placeholder="Publish to get a link"/>
      <button id="btnCopy"><i class="fa-solid fa-copy"></i> Copy</button>
    </div>
  </div>
  <div class="card" style="flex:1;">
    <h2><i class="fa-solid fa-eye"></i> Preview</h2>
    <iframe id="preview"></iframe>
  </div>
</div>

<div id="viewerView" style="display:none;">
  <iframe id="viewer" style="width:100%;height:100%;border:none;"></iframe>
</div>

<script>
function utf8ToBase64(str){return btoa(unescape(encodeURIComponent(str)));}
function base64ToUtf8(b64){return decodeURIComponent(escape(atob(b64)));}

const editorView = document.getElementById('editorView');
const viewerView = document.getElementById('viewerView');
const editor = document.getElementById('editor');
const preview = document.getElementById('preview');
const viewer = document.getElementById('viewer');
const shareUrl = document.getElementById('shareUrl');
const toggleTheme = document.querySelector('.toggle-theme');

const m = location.hash.match(/#html=([^&]+)/);
if(m){
  try{
    const html = base64ToUtf8(decodeURIComponent(m[1]));
    viewerView.style.display = "block";
    editorView.style.display = "none";
    viewer.srcdoc = html;
  }catch(e){ console.error(e); }
}else{
  editorView.style.display = "flex";
  editor.value = "<!doctype html>\n<html>\n<head>\n<title>This Is My Site </title>\n</head>\n<body>\n<h1>fuck me man</h1>\n</body>\n</html>";
  preview.srcdoc = editor.value;
}

// Auto preview on typing with debounce
let timeout;
editor.addEventListener('input', ()=>{
  clearTimeout(timeout);
  timeout = setTimeout(()=>{ preview.srcdoc = editor.value; }, 150);
});

// Publish & Copy
document.getElementById('btnPublish').onclick = ()=>{
  const html = editor.value;
  const b64 = utf8ToBase64(html);
  const url = location.origin + location.pathname + "#html=" + encodeURIComponent(b64);
  shareUrl.value = url;
}
document.getElementById('btnCopy').onclick = async ()=>{
  try{ await navigator.clipboard.writeText(shareUrl.value); }catch(e){ alert("Copy failed"); }
}

// Toggle Dark/Light Theme
toggleTheme.addEventListener('click', ()=>{
  document.body.classList.toggle('light');
  toggleTheme.innerHTML = document.body.classList.contains('light') 
    ? '<i class="fa-solid fa-moon"></i> Toggle Theme'
    : '<i class="fa-solid fa-sun"></i> Toggle Theme';
});
</script>

</body>
</html>
